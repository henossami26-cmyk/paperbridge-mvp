<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PaperBridge â€” MVP</title>
  <style>
    body{font:16px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:24px;background:#f7f7fb}
    .wrap{max-width:1100px;margin:0 auto}
    h1{margin:0 0 12px}
    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
    .card{background:#fff;border:1px solid #e6e6ef;border-radius:12px;box-shadow:0 1px 3px rgba(0,0,0,.04)}
    .in{padding:16px}
    textarea{width:100%;height:230px;border:1px solid #d7d7e6;border-radius:10px;padding:12px;resize:vertical}
    .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    button{border:1px solid #d7d7e6;border-radius:10px;background:#0f62fe;color:#fff;padding:8px 12px;cursor:pointer}
    button.secondary{background:#fff;color:#0f172a}
    .out{background:#fff;border:1px solid #e6e6ef;border-radius:12px;padding:16px;min-height:120px}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#eef2ff;color:#1f2937;font-size:12px;border:1px solid #c7d2fe;margin-right:6px}
    .list li{padding:8px 0;border-top:1px solid #f0f0f6}
    small{color:#6b7280}
  </style>
</head>
<body>
<div class="wrap">
  <h1>ðŸŒ‰ PaperBridge â€” Understand Every Form</h1>
  <p><small>Client-only demo. No data leaves your browser.</small></p>

  <div class="grid">
    <div class="card">
      <div class="in">
        <label><strong>Paste form text</strong></label>
        <textarea id="input">By signing this form, the applicant hereby consents to disclose their SIN pursuant to the program assessment. Notwithstanding any other provision herein, failure to remit sufficient documentation may render the application void.</textarea>
        <div class="row">
          <button id="btnSimple">Simplify</button>
          <button id="btnLine" class="secondary">Line-by-line</button>
          <button id="btnCopy" class="secondary">Copy simplified</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="in">
        <div class="row">
          <span class="pill" id="modePill">Mode: Simple</span>
          <span class="pill" id="termPill">Terms: 0</span>
        </div>
        <div id="output" class="out"></div>
      </div>
    </div>
  </div>

  <div class="grid" style="margin-top:16px">
    <div class="card">
      <div class="in">
        <div><strong>Glossary</strong></div>
        <ul id="gloss" class="list"></ul>
      </div>
    </div>
    <div class="card">
      <div class="in">
        <div><strong>Tips</strong></div>
        <ol>
          <li>Use **Line-by-line** to see each sentence with its simpler version.</li>
          <li>Weâ€™ll add a private **Profile Vault** next (name, DOB, address, passport, SIN).</li>
          <li>Then weâ€™ll **auto-fill PDFs** in-browser using your profile.</li>
        </ol>
      </div>
    </div>
  </div>
</div>

<script>
const JARGON_MAP = {
  "hereby": { simple: "by this", note: "Formal for â€˜by this document/actionâ€™." },
  "thereof": { simple: "of that", note: "Refers back to something earlier." },
  "therein": { simple: "in that", note: "Means â€˜in that place/documentâ€™." },
  "herein": { simple: "in this", note: "Means â€˜in this documentâ€™." },
  "notwithstanding": { simple: "despite", note: "Prefer â€˜despiteâ€™." },
  "pursuant": { simple: "according to", note: "â€˜in line with / according toâ€™." },
  "commence": { simple: "start", note: "Simpler than â€˜beginâ€™." },
  "terminate": { simple: "end", note: "Simpler than â€˜finishâ€™." },
  "remit": { simple: "send/pay", note: "Often to send a payment." },
  "sufficient": { simple: "enough", note: "Simple synonym." },
  "utilize": { simple: "use", note: "Prefer â€˜useâ€™." },
  "applicant": { simple: "person applying", note: "The person filling the form." },
  "reside": { simple: "live", note: "Where you live." },
  "domicile": { simple: "permanent home", note: "Your main legal home." },
  "affix": { simple: "attach", note: "Often for signatures/photos." },
  "affidavit": { simple: "sworn statement", note: "Written statement promised as true." },
  "consent": { simple: "permission", note: "Saying â€˜yesâ€™." },
  "disclose": { simple: "share", note: "Share information." },
  "verify": { simple: "confirm", note: "Make sure itâ€™s true." },
  "invalid": { simple: "not accepted", note: "Wonâ€™t be allowed." },
  "eligible": { simple: "allowed to apply", note: "Meets the rules." },
  "ineligible": { simple: "not allowed to apply", note: "Doesnâ€™t meet the rules." },
  "dependent": { simple: "person you support", note: "Child/parent relying on you." },
  "spouse": { simple: "husband or wife", note: "Married partner." },
  "common-law": { simple: "live-in partner (12+ months)", note: "Partner youâ€™ve lived with 12+ months." },
  "sin": { simple: "Social Insurance Number", note: "9-digit number for work/taxes (Canada)." },
  "assessment": { simple: "review/decision", note: "Governmentâ€™s review or decision." },
  "penalty": { simple: "extra charge", note: "Fee for breaking a rule/being late." },
  "void": { simple: "cancel", note: "Make something not valid." }
};

function splitSentences(text){
  return text.trim().replace(/\s+/g,' ').split(/(?<=[.!?])\s+/);
}

function simplify(text){
  const sentences = splitSentences(text);
  const hits = {};
  const simplifiedSentences = sentences.map(s =>
    s.replace(/\b[\w-]+\b/gi, token => {
      const key = token.replace(/[^\w-]/g,'').toLowerCase();
      const item = JARGON_MAP[key];
      if(!item) return token;
      if(!hits[key]) hits[key] = { ...item, count:0 };
      hits[key].count++;
      return item.simple;
    })
  );
  return {
    sentences,
    simplifiedSentences,
    simplified: simplifiedSentences.join(' '),
    glossary: Object.entries(hits).map(([term, v]) => ({term, ...v}))
  };
}

const inputEl = document.getElementById('input');
const outputEl = document.getElementById('output');
const glossEl = document.getElementById('gloss');
const termPill = document.getElementById('termPill');
const modePill = document.getElementById('modePill');

function render(mode='simple'){
  const r = simplify(inputEl.value);
  modePill.textContent = `Mode: ${mode==='simple' ? 'Simple' : 'Line-by-line'}`;
  termPill.textContent = `Terms: ${r.glossary.length}`;

  if(mode==='simple'){
    outputEl.innerHTML = r.simplified;
  } else {
    outputEl.innerHTML = r.sentences.map((s,i)=>`
      <div style="margin-bottom:12px">
        <div><small>Original</small><br>${s}</div>
        <div style="margin-top:6px"><small>Simplified</small><br><strong>${r.simplifiedSentences[i]}</strong></div>
      </div>
    `).join('');
  }

  if(r.glossary.length===0){
    glossEl.innerHTML = '<li><small>No special terms detected.</small></li>';
  } else {
    glossEl.innerHTML = r.glossary.map(g=>`
      <li>
        <div><strong>${g.term}</strong></div>
        <div>${g.simple}</div>
        <div><small>${g.note}</small></div>
      </li>
    `).join('');
  }
}

document.getElementById('btnSimple').onclick = () => render('simple');
document.getElementById('btnLine').onclick = () => render('line');
document.getElementById('btnCopy').onclick = async () => {
  const r = simplify(inputEl.value);
  try { await navigator.clipboard.writeText(r.simplified); alert('Copied!'); }
  catch { alert('Could not copy.'); }
};

render('simple');
</script>
</body>
</html>
